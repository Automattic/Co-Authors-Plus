!function(){var e,t={992:function(e,t,r){"use strict";var o=window.wp.element,n=window.wp.plugins,a=window.wp.editPost,s=window.wp.i18n,u=window.wp.data,l=window.wp.apiFetch,c=r.n(l),i=window.wp.components,p=window.wp.hooks,h=window.wp.compose,m=r(697),d=r.n(m),v=window.wp.primitives,f=(0,o.createElement)(v.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,o.createElement)(v.Path,{d:"M6.5 12.4L12 8l5.5 4.4-.9 1.2L12 10l-4.5 3.6-1-1.2z"})),g=(0,o.createElement)(v.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,o.createElement)(v.Path,{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"})),w=(0,o.createElement)(v.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,o.createElement)(v.Path,{d:"M13 11.8l6.1-6.3-1-1-6.1 6.2-6.1-6.2-1 1 6.1 6.3-6.5 6.7 1 1 6.5-6.6 6.5 6.6 1-1z"}));const E=(e,t,r)=>{const o=t.map((e=>e.value)).indexOf(e.value),n=o+("up"===r?-1:1),a=t.map((e=>Object.assign({},e))),s=a[o],u=[...a.filter((e=>e.value?e.value!==s.value:e!==s))];return u.splice(n,0,s),u},b=e=>{const{displayName:t,userNicename:r,email:o}=e;return{label:(0,p.applyFilters)("coAuthors.author.label.formatted",`${t} | ${o}`,e),display:t,value:r}},_=e=>{let{selectedAuthors:t,updateAuthors:r}=e;const n=(e,o)=>{let n;switch(o){case"moveDown":n=E(e,t,"down");break;case"moveUp":n=E(e,t,"up");break;case"remove":a=e,n=t.filter((e=>e.value!==a.value))}var a;r(n)};return null!=t&&t.length?t.map(((e,r)=>{const a=e.display,u=e.value;return(0,o.createElement)("div",{key:u,className:"cap-author"},(0,o.createElement)(i.Flex,{align:"flex-start"},(0,o.createElement)(i.FlexItem,{className:"cap-author-flex-item"},(0,o.createElement)("span",null,a)),(0,o.createElement)(i.FlexItem,{justify:"flex-end",className:"cap-author-flex-item"},(0,o.createElement)(i.Flex,null,(0,o.createElement)("div",{className:"cap-icon-button-stack"},(0,o.createElement)(i.Button,{icon:f,className:"cap-icon-button",label:(0,s.__)("Move Up","co-authors-plus"),disabled:0===r||1===t.length,onClick:()=>n(e,"moveUp")}),(0,o.createElement)(i.Button,{icon:g,className:"cap-icon-button",label:(0,s.__)("Move down","co-authors-plus"),disabled:r===t.length-1||1===t.length,onClick:()=>n(e,"moveDown")})),(0,o.createElement)(i.Button,{icon:w,iconSize:20,className:"cap-icon-button",label:(0,s.__)("Remove Author","co-authors-plus"),disabled:1===t.length,onClick:()=>n(e,"remove")})))))})):null};_.propTypes={selectedAuthors:d().arrayOf([d().shape({id:d().oneOfType([d().string,d().number]),userNiceName:d().string,login:d().string,email:d().string,displayName:d().string,avatar:d().string})]).isRequired,updateAuthors:d().func.isRequired};var y=_;const S={authors:[]},A={setAuthors(e){return{type:"SET_AUTHORS",authors:[...e]}},setAuthorsStore(e){return{type:"SET_AUTHORS_STORE",authors:[...e]}},apiRequest(e){return{type:"API_REQUEST",path:e,method:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET"}}};var O=(0,u.createReduxStore)("cap/authors",{reducer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_AUTHORS":return{...e,authors:[...e.authors,...t.authors]};case"SET_AUTHORS_STORE":return{...e,authors:[...t.authors]}}return e},actions:A,selectors:{getAuthors(e){const{authors:t}=e;return t},saveAuthors(e){const{authors:t}=e;return t}},controls:{API_REQUEST(e){return c()({path:e.path,method:e.method})}},resolvers:{*getAuthors(e){if(!e)return A.setAuthors([]);const t=`/coauthors/v1/authors/${e}`,r=(yield A.apiRequest(t)).map((e=>b(e)));return A.setAuthors(r)},*saveAuthors(e,t){const r=`/coauthors/v1/authors/${e}?new_authors=${t.map((e=>e.value)).join(",")}`;yield A.apiRequest(r,"POST")}}});(0,u.register)(O);var x=()=>{const[e,t]=(0,o.useState)([]),[r,n]=(0,o.useState)([]),a=(0,u.useSelect)((e=>e("core/editor").getCurrentPostId())),l=((0,u.useSelect)((e=>{var t;return null===(t=e("cap/authors"))||void 0===t?void 0:t.saveAuthors}),[]),(0,u.useSelect)((e=>{var t;return null===(t=e("cap/authors"))||void 0===t?void 0:t.getAuthors(a)}),[a])),{setAuthorsStore:m}=(0,u.useDispatch)("cap/authors"),d=((0,u.useSelect)((e=>e("core/editor").isSavingPost)),(0,p.applyFilters)("coAuthors.search.threshold",2)),v=e=>{m(e),t(e)},f=(0,h.useDebounce)((async t=>{let r=0;if(t.length<d)return void n([]);const o=e.map((e=>e.value)).join(",");try{r=await c()({path:`/coauthors/v1/search/?q=${t}&existing_authors=${o}`,method:"GET"});const e=(a=r).length>0?a.map((e=>b(e))):[];n(e)}catch(e){r=0,console.log(e)}var a}),500);return(0,o.useEffect)((()=>{l.length&&v(l)}),[l]),(0,o.createElement)(o.Fragment,null,Boolean(e.length)?(0,o.createElement)(o.Fragment,null,(0,o.createElement)(y,{selectedAuthors:e,updateAuthors:v})):(0,o.createElement)(i.Spinner,null),(0,o.createElement)(i.ComboboxControl,{className:"cap-combobox",label:(0,s.__)("Select An Author","co-authors-plus"),value:null,options:r,onChange:t=>{const o=((e,t,r)=>[...t,r.filter((t=>t.value===e))[0]])(t,e,r);v(o)},onFilterValueChange:f}))};(0,n.registerPlugin)("plugin-coauthors-document-setting",{render:()=>(0,o.createElement)(a.PluginDocumentSettingPanel,{name:"coauthors-panel",title:(0,s.__)("Authors","co-authors-plus"),className:"coauthors"},(0,o.createElement)(x,null)),icon:"users"});const{isSavingPost:T,getCurrentPost:P}=(0,u.select)("core/editor"),{getAuthors:R,saveAuthors:k}=(0,u.select)("cap/authors");let C=!0;(0,u.subscribe)((()=>{if(T())C=!1;else if(!C){const{id:e}=P(),t=R(e);k(e,t),C=!0}}))},703:function(e,t,r){"use strict";var o=r(414);function n(){}function a(){}a.resetWarningCache=n,e.exports=function(){function e(e,t,r,n,a,s){if(s!==o){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:n};return r.PropTypes=r,r}},697:function(e,t,r){e.exports=r(703)()},414:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}},r={};function o(e){var n=r[e];if(void 0!==n)return n.exports;var a=r[e]={exports:{}};return t[e](a,a.exports,o),a.exports}o.m=t,e=[],o.O=function(t,r,n,a){if(!r){var s=1/0;for(i=0;i<e.length;i++){r=e[i][0],n=e[i][1],a=e[i][2];for(var u=!0,l=0;l<r.length;l++)(!1&a||s>=a)&&Object.keys(o.O).every((function(e){return o.O[e](r[l])}))?r.splice(l--,1):(u=!1,a<s&&(s=a));if(u){e.splice(i--,1);var c=n();void 0!==c&&(t=c)}}return t}a=a||0;for(var i=e.length;i>0&&e[i-1][2]>a;i--)e[i]=e[i-1];e[i]=[r,n,a]},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,{a:t}),t},o.d=function(e,t){for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={826:0,431:0};o.O.j=function(t){return 0===e[t]};var t=function(t,r){var n,a,s=r[0],u=r[1],l=r[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(n in u)o.o(u,n)&&(o.m[n]=u[n]);if(l)var i=l(o)}for(t&&t(r);c<s.length;c++)a=s[c],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(i)},r=self.webpackChunkco_authors_plus_3_5_3=self.webpackChunkco_authors_plus_3_5_3||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var n=o.O(void 0,[431],(function(){return o(992)}));n=o.O(n)}();